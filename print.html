<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>test_lvasp</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="ex01.html"><strong aria-hidden="true">1.</strong> Chapter 1</a></li><li class="chapter-item expanded "><a href="ex02.html"><strong aria-hidden="true">2.</strong> Chapter 2</a></li><li class="chapter-item expanded "><a href="ex03.html"><strong aria-hidden="true">3.</strong> Chapter 3</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">test_lvasp</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>title: Ex01 VASP基本输入文件的准备（壹）
categories:</p>
<ul>
<li>LVASPTHW
tags:</li>
<li>VASP 输入文件
date: 2017-10-14 15:30:00</li>
</ul>
<hr />
<p>基本的输入文件，指的是VASP计算必不可少的输入文件，对新手来说先记住这四个文件的名字：INCAR，KPOINTS，POSCAR，POTCAR。具体是干嘛用的？不懂的话不要紧，后面我们会结合例子，慢慢介绍这几个文件的准备工作。</p>
<h3 id="基本概念"><a class="header" href="#基本概念">基本概念</a></h3>
<p>准备输入文件， 脑子里要有下面几个概念:</p>
<ul>
<li>
<p>Rubbish in，Rubbish out!  程序只负责算，对错由你决定！错误主要有3类：</p>
<ul>
<li>模型错误：也就是建模这一块出错了，主要对应的是POSCAR；</li>
<li>计算参数：INCAR，KPOINTS，POTCAR</li>
<li>提交任务的脚本或者命令出错。</li>
</ul>
</li>
<li>
<p>遇到不懂的参数： (思考 + 看官网)！ (思考 + 看官网)！ (思考 + 看官网)！</p>
</li>
<li>
<p>重要的话说三遍，尽量不要去看网上那些乱七八糟的教程。如果英语不好，那么这是一个锻炼你阅读能力的好机会。通过查阅官网解决问题，可以保证你的血统纯正，进而提高你的杀伤力。</p>
</li>
<li>
<p>所有的输入文件都只是文本而已。这句话的意思是：所有的输入文件都可以通过文本编辑器打开，比如：</p>
</li>
<li>
<ul>
<li>Linux下面可以用Vim</li>
<li>Windows下用Notepad++</li>
<li>杜绝使用Windows自带的文本编辑器：记事本，写字板。</li>
</ul>
</li>
<li>
<p>所有的输入文本没有尾缀，Windows用户可能习惯了带各种各样尾缀的文件，但是vasp里面的输入文件，没有尾缀且都是文本。 比如你使用Notepad++这个文本编辑器写了一个输入文件，直接并保存成 INCAR就可以了。如果不小心保存成了 INCAR.txt，那么直接将尾缀.txt删除即可。</p>
</li>
<li>
<p>再次强调:对于Windows用户，本书中指的文本编辑器是:Notepad++。免费的软件，大家自己下载并安装。 请不要用写字板，记事本等编辑VASP的输入文件。如果你不听话，还是喜欢用它们，那么:</p>
<ul>
<li>出错，自己负责，有时候你会死的很惨，折腾很久可能都找不到哪里出错了；</li>
<li>出错，自己检查有没有在提交任务前运行：dos2linux 这个命令转换下格式</li>
</ul>
</li>
<li>
<p>一步一步按照本书的练习进行操作，有问题，先记下来，如果后面没有得到解答，去**《序言》**找联系方式咨询大师兄。</p>
</li>
</ul>
<h3 id="vasp输入和输出文件"><a class="header" href="#vasp输入和输出文件">VASP输入和输出文件</a></h3>
<ul>
<li>
<p>有了上面的概念，我们就可以准备输入文件了。下面是官网列出VASP的输入和输出文件，in 代表输入，out代表输出。先声明一下：大家不要被下面这么多文件吓傻了，脑子里有个印象就行，很多文件可能穷奇你一生的计算都用不到，而且你以后会花很多时间在删这些乱七八糟的文件上面。对于新手的话，大家先简单过目一下即可。可以理解为，从未开过车的你，一下子钻到车里，首先要做的就是熟悉车内部的环境，具体什么功能、怎么回事，后面慢慢摸索。</p>
<pre><code>INCAR      in    **
STOPCAR    in
stout      out
POTCAR     in     **
KPOINTS    in     **
IBZKPT     out
POSCAR     in     **
CONTCAR    out
CHGCAR     in/out
CHG        out
WAVECAR    in/out
TMPCAR     in/out
EIGENVAL   out
DOSCAR     out
PROCAR     out
OSZICAR    out
PCDAT      out
XDATCAR    out
LOCPOT     out
ELFCAR     out
PROOUT     out
</code></pre>
</li>
<li>
<p>对于VASP计算来说，前面这一大堆中的 INCAR ， KPOINTS， POSCAR 和POTCAR 是必不可少的输入文件，必须有!</p>
<ul>
<li>INCAR 告诉VASP算什么，怎么算。</li>
<li>KPOINTS 包含计算的K点信息（K点是什么，这个问题很抽象，脑子里先记住，计算的时候必须有这个东西）。</li>
<li>POSCAR是计算模型结构的文字描述，也就是各个原子在xyz方向的坐标信息。</li>
<li>POTCAR对应的是计算过程中每个原子的平面波基组，描述体系中对应的原子核和电子的相关信息。</li>
<li>提交任务的脚本或者命令，需要你自己准备，没有在列表里面。</li>
</ul>
</li>
</ul>
<p><strong>注意</strong></p>
<p>最新版的VASP中可以在INCAR中设置KPOINTS。但在涉及到计算能带的特殊K点时候，INCAR中就不可以直接设置了。所以，在本书中，KPOINTS是认为必须有的。请不要再纠结这个问题，也不要专门找我争论这个问题。如果你认为可以没有，那就是可以没有。至少本书中，我们会介绍KPOINTS文件的准备工作。</p>
<p>这一节，我们主要通过VASP官网中O原子的计算实例，来学习INCAR的文件准备工作。记住前面我们说的话，INCAR是纯文本。Windows用户，不要用记事本或者写字板打开。推荐使用<a href="https://notepad-plus-plus.org/">Notepad++</a>。</p>
<h3 id="简单说明"><a class="header" href="#简单说明">简单说明</a></h3>
<p>INCAR主要是告诉VASP我们要算什么以及计算的细节，INCAR准备的原则是：<strong>越简单越好</strong>，<strong>不知道的，不理解的就不往里面放</strong>。 下面是给新手们的一些建议：</p>
<ul>
<li>
<p>INCAR 中有很多参数，改变参数来控制计算细节，从而得到我们期望的结果。所以，记住：Rubbish in， Rubbish out。自己算什么，心里要有数。</p>
</li>
<li>
<p>网上很多人发INCAR的教程，列了一堆参数进去，甚至长达两页，有些连默认值也放在里面了，恨不得把所有参数全部放进去。不过，请记住：那些令人眼花缭乱的只是唬人装逼用的，在实际计算中会严重拖你的后腿，占了那么多行，修改起来也费劲。</p>
</li>
<li>
<p>熟知各个参数的数值意义，以及在不同计算任务中的设置至关重要。</p>
</li>
<li>
<p>有人会说，那么多参数，怎么能记得过来？ 放心，完全可以的。</p>
<ul>
<li>
<p>一方面，对于特定的体系，所需要的参数不同。如果你的课题比较稳定，那么你应该不会接触太多的参数。比如你专注于体系的能带结构，那么算过渡态的参数你就不会需要。</p>
</li>
<li>
<p>另一方面，这些计算参数又不是一天两天能记住的，是一个长期积累的过程。随着时间的增长和个人经验的增加，自然而然地就记住了。</p>
</li>
</ul>
</li>
</ul>
<h3 id="incar-的输入工作"><a class="header" href="#incar-的输入工作">INCAR 的输入工作</a></h3>
<p>打开编辑器，把下面几行挨个输入进去: （#以及后面的就不要输入了）</p>
<pre><code>SYSTEM = O atom       # 氧元素符号，不是零!
ISMEAR = 0            # 是零，不是氧元素符号，对于分子或者原子，用0.
SIGMA = 0.01          # 对于分子或者原子，用0.01
</code></pre>
<p><strong>INCAR的注意事项：</strong></p>
<ul>
<li>
<p>**#**后面写的是汉语，是给大家展示用的。 大家在写INCAR的时候，最好不要把汉语写进去，有可能会出错！</p>
</li>
<li>
<p>**#**号后面的内容对计算不会造成影响，主要作为注释用，解释这个参数干嘛用的，可以不用输入；</p>
</li>
<li>
<p>每个参数后面跟着等号 <strong>=</strong> ， </p>
</li>
<li>
<p>等号（<strong>=</strong>）前后可以有空格，也可以没有。<code>ISMEAR=0</code> 和 <code>ISMEAR = 0</code> 是一样的，</p>
</li>
<li>
<p>写INCAR的时候，<strong>不要使用 tab</strong>，用空格替换tab；</p>
</li>
<li>
<p>官网有些旧的文件可能用的不是 # 号，而是 !， ! 可能会出错。最好的办法就是记住参数是干嘛用的，# 和 ！ 都不写。</p>
</li>
</ul>
<h3 id="incar的详解"><a class="header" href="#incar的详解">INCAR的详解</a></h3>
<h4 id="system"><a class="header" href="#system">SYSTEM</a></h4>
<p>SYSTEM 后面是该计算的说明。你的这个任务算的是什么，目的是什么，体系是什么？等等，这些都可以<strong>随便</strong>写在里面，<strong>随便</strong>的意思就是可以任意写。</p>
<ul>
<li>SYSTEM = O atom 和 SYSTEM = I LOVE BigBro  和 SYSTEM = VASP， 除了多出几个字符外，对计算没有什么影响。</li>
<li>情诗，骂人的话也可以写在 = 后面。但不建议大家在这一行里写一堆乱七八糟的东西，另外还是得避免把中文写在这里；</li>
<li>当然，这一行有或者没有，对计算结果不会有任何影响，看着不爽也可以直接删除。</li>
</ul>
<h4 id="ismear"><a class="header" href="#ismear">ISMEAR</a></h4>
<p>ISMEAR这一项，目前需要记住的是：</p>
<ul>
<li>1）<strong>不同的值对应的是不同的展宽方法</strong>；</li>
<li>2）<strong>对于分子，原子的计算用0</strong>。</li>
</ul>
<p>下面是VASP官网的一些解释，新手暂时看不懂不要紧，把需要记住的这两条死死记住就可以了。</p>
<ul>
<li>对于半导体和绝缘体体系，ISMEAR的值取绝对不能大于0， 一般用0；</li>
<li>对所有体系，如果想获取更加精确能量的时候用-5，但这时候如果K点数目小于3，程序则会罢工；</li>
<li>K 点少，半导体或者绝缘体，那么只能用 ISMEAR = 0；</li>
<li>在DOS能带计算中，使用ISMEAR= -5 用于获取精确的信息。 </li>
<li>对于金属来说，ISMEAR的取值一般为&gt;=0 的数值（0,1,2）；</li>
<li>保守地说，ISMEAR = 0 (Gaussian Smearing) 可以满足大部分的体系（金属，导体，半导体，分子）；</li>
<li>如果不知道怎么取ISMEAR，直接用0是一个很保险的做法。也可以测试不同的值对计算的影响，但是新手的话，即使测试完了，也不知道根据什么去判断对结果的影响。</li>
</ul>
<h4 id="sigma"><a class="header" href="#sigma">SIGMA:</a></h4>
<p>SIGMA的取值和ISMEAR息息相关，也就是和ISMEAR这个参数同时出现，设定。下面是一些基本的介绍：</p>
<ul>
<li>
<p>如果用了ISMEAR = -5； SIGMA的值可以忽略，也可以不管。（对于所有体系都适用)；</p>
</li>
<li>
<p>对于金属： ISMEAR = 1 或者0，非金属: ISMEAR= 0 的时候，一般取 SIGMA = 0.10 即可，默认值是0.20。不放心的话，用0.05。</p>
</li>
<li>
<p>对于气体分子，原子体系（也就是你把分子或者原子放到一个box里面）：死死记住下面组合就可以了， ISMEAR = 0; SIGMA = 0.01。</p>
</li>
</ul>
<p>不过很多人都不放心，为了保险想测试一番。标准是： SIGMA的取值要保证OUTCAR 中的 entropy T*S 这一项，平均到每个原子上，要小于 1-2 meV。检查的时候可以用这个命令: </p>
<pre><code>grep 'entropy T'  OUTCAR 
</code></pre>
<p>**注意1：**这里有两个单引号，不要输入的时候漏掉。</p>
<p>用这个命令，得出的能量除以体系中原子的数目（也就是平均到每个原子上），然后再和 0.001 eV 比较。如果小于，SIGMA取值OK，如果大于，再换个小点的数值进行测试。</p>
<p>**注意2：**这里的说的entropy，是因为ISMEAR展宽这个计算方法引入的，跟我们物理化学书里面的entropy完全是两码事。后面我们会介绍如何通过频率分析计算物理化学里面的Entropy。千万别把这个数值当成频率所对应的entropy。</p>
<h3 id="incar的保存"><a class="header" href="#incar的保存">INCAR的保存</a></h3>
<p>输入完上面的几行，我们就可以保存INCAR文件了。这里需要注意的是：INCAR后面没有尾缀，**所以：INCAR.txt是错误的。**为避免这个问题：</p>
<ul>
<li>
<p>Notepad++ 保存的时候，文件名为: INCAR，保存类型选择 Alltypes (<em>.</em>)。</p>
</li>
<li>
<p>用Vim的筒子们直接将前面的内容保存成INCAR即可。</p>
</li>
<li>
<p>将INCAR.txt 通过<code>mv</code>命令重命名为INCAR。</p>
<pre><code class="language-bash">mv INCAR.txt INCAR -f
</code></pre>
</li>
</ul>
<p>前面说了很多，对新手，可能会犯晕。不过不用担心，<strong>只要记住关键三点，我们就圆满完成本节的任务</strong>：</p>
<ul>
<li>
<p>INCAR是纯文本没有尾缀; </p>
</li>
<li>
<p>算原子或者分子时：ISMEAR = 0， SIGMA = 0.01</p>
</li>
<li>
<p>Windows用户请使用Notepad++作为文本编辑器，不要使用自带的记事本或者写字板，如果使用了，计算前务必要通过<code>dos2unix</code>转换一下格式：</p>
<pre><code class="language-bash">dos2unix INCAR 
</code></pre>
</li>
</ul>
<p>上一节，我们学习了INCAR的简单准备工作。这一节，我们学习另外一个输入文件的写法：<em><strong>KPOINTS</strong></em></p>
<h3 id="简单说明-1"><a class="header" href="#简单说明-1">简单说明</a></h3>
<p>KPOINTS文件在计算中的作用，一方面决定了计算的精度，同时也影响计算所需要的时间。精度高，时间长，精度低，时间短。所以：合理设置KPOINTS文件，可以保证我们使用最少的时间，来获取准确可靠的结果。</p>
<h3 id="kpoints的输入和保存"><a class="header" href="#kpoints的输入和保存">KPOINTS的输入和保存</a></h3>
<p>打开编辑器，把下面几行输入进去: </p>
<pre><code>K-POINTS      #  第一行随便写都行，但不能没有
 0             # 零，格子自动生成
Gamma         #  gamma点centered 
1 1 1         #  1*1*1格子
0 0 0         #  S1 S2 S3， 一般保持 0 0 0 不变。
</code></pre>
<p><strong>详解:</strong></p>
<ul>
<li>
<p>该KPOINTS 文件里面，共有5行，#号以及后面的不用输入；</p>
</li>
<li>
<p>同INCAR的注释一样，不要在每一行后面使用 ! 来进行注释，要使用 #，且最好不要写中文。 </p>
</li>
<li>
<p>第一行：可以随便写内容，但不能没有;</p>
</li>
<li>
<p>第二行：数字0，不是字母O，0 在这里表示的是自动生成K点。你可能注意到了，0前面有个空格，不过没关系，对计算不影响，可以删掉，也可以再加一个空格，后面的同样如此。 但是避免用tab输入，VASP有时候不识别tab键输入的空白部分，导致计算出错；</p>
</li>
<li>
<p>第三行：VASP只认第一个字母，大小写均可。在这里Gamma和gamma，Gorge，gorge效果是一样的，当然这一行也可以直接写字母G或者g。</p>
<ul>
<li>G表示的是以gamma点为中心生成网格。</li>
<li>另外一种是原始的Monkhorst-Pack 网格，两者的区别是 M 或者 m 在 G的基础上在三个方向上平移了1/（2N）个单位。</li>
<li>G，也叫 gamma centered Monkhorst-Pack Grid；所以，gamma centered 只是MP网格的一种特殊情况。</li>
</ul>
</li>
<li>
<p>第四行，在xyz三个方向上生成对应数目的K点，本例是111;</p>
<ul>
<li>对于原子或者分子的计算，K点取一个gamma点就够了（1 1 1），也就是这个KPOINTS文件可以用于绝大多数的原子或者分子计算，不用再修改；</li>
<li>但如果你要用ISMEAR = -5 来计算能量，那么就需要把 1 1 1 改成 2 2 2或者3 3 3。</li>
</ul>
</li>
<li>
<p>第五行，一般都写成 0 0 0 ，不用动即可；</p>
</li>
<li>
<p>按照前面INCAR的方式保存文件，名字为KPOINTS。</p>
</li>
</ul>
<h3 id="kpoints的建议"><a class="header" href="#kpoints的建议">KPOINTS的建议</a></h3>
<p>K点在VASP计算中非常重要，大师兄给的一个建议是：</p>
<ul>
<li>
<p>一直用gamma centered，也就是第三行保持G不变。因为M平移之后，网格的对称性和晶胞的对称性会出现不匹配的情况，从而导致计算出错，尤其是对于六角晶系hexagonal的结构，必须用gamma centered!这一点，vasp官网说的很明确；其他的建议后续慢慢展开讨论。</p>
</li>
<li>
<p>如非六角晶系的计算，如果已经设置的M算起来了，继续用M算就行，没必要改成G再重新算一遍；</p>
</li>
<li>
<p>前面看不懂，没事。<strong>记住这一点，本节就圆满完成任务</strong>：气体分子，原子计算的时候，使用gamma点即可。</p>
</li>
</ul>
<p>这一节，我们学习VASP计算中模型的文件：<em><strong>POSCAR</strong></em></p>
<h3 id="简单说明-2"><a class="header" href="#简单说明-2">简单说明</a></h3>
<p>POSCAR 里面包含了你要进行计算的模型结构信息。也就是你要研究的对象。POSCAR有自己固定的格式，每一行都有特定的含义，认真掌握这些，对于搭建模型非常有帮助。对于本节的例子：O原子的计算中，我们要把O原子放到一个格子里面，格子大小为：8 $\times$ 8 $\times$ 8 $\AA{^3}$。那么POSCAR应该这样写。</p>
<h4 id="poscar的输入"><a class="header" href="#poscar的输入">POSCAR的输入</a></h4>
<pre><code>O atom in a box 
1.0             # universal scaling parameters 
8.0 0.0 0.0     # lattice vector a(1) 
0.0 8.0 0.0     # lattice vector a(2)  
0.0 0.0 8.0     # lattice vector a(3)  
O               # O element， not zero
1               # number of atoms 
Cartesian       # positions in cartesian coordinates 
0 0 0           #
</code></pre>
<p><strong>详解：</strong></p>
<ul>
<li>
<p>第一行：同样随便写，但不能不写；</p>
</li>
<li>
<p>第二行：Scale factor，称为缩放系数，这里是1.0；</p>
</li>
<li>
<p>第三到五行：是组成格子的三条边的坐标信息；从原点出发，在xyz轴上分别取8$\AA$。这个很容易理解；</p>
</li>
<li>
<p>第六行：体系中的元素，这里我们算的是氧原子，所以写：O，即氧的元素符号。需要注意的有以下几点：</p>
<ul>
<li>vasp4.xx版本里面没有这一行，不过现在几乎没人用4.X的版本了；</li>
<li>O的符号和数字0容易混淆，一定要注意；</li>
<li>第一个元素符号要顶格写，前面不要有空格，有可能会出错；</li>
<li>如果计算文件夹里面，已经有与结构相一致的POTCAR，那么POSCAR里面即使删了这一行有不会影响计算，VASP会读取POTCAR中的元素信息，但输出文件CONTCAR中会把该行自动加上。（新手跳过）</li>
</ul>
</li>
<li>
<p>第七行：与第六行中元素相对应的原子数目，这里我们只有1个氧原子，所以写成1；</p>
</li>
<li>
<p>第八行：体系中原子的坐标系，可以为笛卡尔坐标，也可以为分数坐标系。注意的有以下几点：</p>
<ul>
<li>这一行同KPOINTS的第三行一样，即只认第一个字母；</li>
<li>C或者c代表笛卡尔坐标， D或者d代表分数坐标系；</li>
<li>VASP输出文件CONTCAR里面采用的是分数坐标系。</li>
</ul>
</li>
<li>
<p>第九行：体系中原子的坐标信息。这里我们把O原子放到了原点（0.0 0.0 0.0）的位置，大家也可以随便放一个位置，比如：（4.0 5.0 6.0），（1.1 2.5 6.5）都是可以的。由于周期性的存在，不管你怎么放，相邻两个格子之间氧原子的距离都是一样的。</p>
</li>
<li>
<p>写完之后，和INCAR，KPOINTS文件一样，直接保存成POSCAR即可。</p>
</li>
</ul>
<h5 id="两点说明"><a class="header" href="#两点说明">两点说明</a></h5>
<ul>
<li>
<p>第二行中的Scale factor还可以写成其他的数字，例如：写成2.0，则后面的格子以及原子坐标相关的数值都要除以2。一般来说，写成1.0即可，这样比较直观，清晰;</p>
</li>
<li>
<p>笛卡尔和分数坐标系的区别是从原子的坐标行开始的（这个例子里面是第8行），即坐标前面的都保持完全一致。 也就是说，如果想从笛卡尔转换成分数坐标，我们只需将Cartesian改成Direct，然后修改后面的原子坐标，而Cartesian行前面的部分保持不变。</p>
</li>
</ul>
<h3 id="本节重点"><a class="header" href="#本节重点">本节重点：</a></h3>
<ul>
<li>学会写O原子在格子里面这个模型的POSCAR；</li>
<li>知道每一行所代表的含义。</li>
</ul>
<p>这一节，我们学习VASP计算中的赝势文件：<em><strong>POTCAR</strong></em></p>
<h3 id="简单说明-3"><a class="header" href="#简单说明-3">简单说明</a></h3>
<p>如果组里安装了VASP，则在某个目录下，一定会有对应的一套对应的赝势文件，本书默认大家已经知道去哪里找，不讨论从哪里下载POTCAR（小窍门：一般各个VASP相关的QQ群中，都会有打包的POTCAR文件）。在该目录下， 一般来说，会有LDA，PBE，和PW91这三个文件夹，主流的计算一般都是用PBE。当你进入PBE的文件夹后，就会找到各个元素所对应的POTCAR文件了。</p>
<p><strong>POTCAR中各项的含义</strong></p>
<p>POTCAR中有很多信息，对于大部分的参数，本人也是只认识字母，不知具体含义，所以只能介绍一下在实际计算中会用到的一些参数。我们用Fe的POTCAR中前面的几行作为一个例子，简单介绍一下。</p>
<pre><code> PAW_PBE Fe 06Sep2000
 8.00000000000000000
 parameters from PSCTR are:
   VRHFIN =Fe:  d7 s1
   LEXCH  = PE
   EATOM  =   594.4687 eV,   43.6922 Ry

   TITEL  = PAW_PBE Fe 06Sep2000
   LULTRA =        F    use ultrasoft PP ?
   IUNSCR =        1    unscreen: 0-lin 1-nonlin 2-no
   RPACOR =    2.000    partial core radius
   POMASS =   55.847; ZVAL   =    8.000    mass and valenz
   RCORE  =    2.300    outmost cutoff radius
   RWIGS  =    2.460; RWIGS  =    1.302    wigner-seitz radius (au A)
   ENMAX  =  267.883; ENMIN  =  200.912 eV
   RCLOC  =    1.701    cutoff for local pot
   LCOR   =        T    correct aug charges
   LPAW   =        T    paw PP
   EAUG   =  511.368
   DEXC   =    -.022
   RMAX   =    2.817    core radius for proj-oper
   RAUG   =    1.300    factor for augmentation sphere
   RDEP   =    2.442    radius for radial grids
   QCUT   =   -4.437; QGAM   =    8.874    optimization parameters
</code></pre>
<p>依个人的学习经验，VRHFIN， LEXCH，TITEL，ZVAL，ENMAX是用到最多的几个参数。</p>
<ul>
<li>VRHFIN 用来看元素的价电子排布，如果你元素周期表倒背如流，可以忽略这个参数；</li>
<li>LEXCH 表示这个POTCAR对应的是GGA-PBE泛函；如果INCAR中不设定泛函，则默认通过这个参数来设定。</li>
<li>TITEL 就不用说了，指的是哪个元素，以及POTCAR发布的时间；</li>
<li>ZVAL 指的是实际上POTCAR中价电子的数目，尤其是做Bader电荷分析的时候，极其重要。</li>
<li>ENMAX 代表默认的截断能。与INCAR中的ENCUT这个参数相关。</li>
</ul>
<p>当然，如果你进入文件夹，使用ls命令后，会发现：即使对于同一个元素来说，也可能会有很多不同的情况。比如：</p>
<ul>
<li>与GW 计算的对应的POTCAR，则标注为：Fe_GW 这样。（GW计算本人没接触过，这里就没有办法继续下去了）；</li>
<li>根据价电子的处理方式，分成了诸如：Fe，Fe_pv，Fe_sv的这样的情况。v是valence的缩写。pv代表把内层的p电子作为价电子来处理。sv代表则是把更内层的s电子也作为价电子来处理。具体到自己体系中的元素，可以结合元素周期表，以及ZVAL关键词所对应的价电子数目，来进行推断。</li>
<li>此时，我们就需要学习一个非常有用的Linux命令了： grep。 下面是我们使用grep命令，来获取所有与Fe相关POTCAR的价电子信息。</li>
</ul>
<pre><code>$ ls Fe*
Fe:
POTCAR  PSCTR

Fe_GW:
POTCAR  PSCTR

Fe_pv:
POTCAR  PSCTR

Fe_sv:
POTCAR  PSCTR

Fe_sv_GW:
POTCAR  PSCTR

$ grep ZVAL Fe*/POTCAR
Fe/POTCAR:   POMASS =   55.847; ZVAL   =    8.000    mass and valenz
Fe_GW/POTCAR:   POMASS =   55.847; ZVAL   =    8.000    mass and valenz
Fe_pv/POTCAR:   POMASS =   55.847; ZVAL   =   14.000    mass and valenz
Fe_sv/POTCAR:   POMASS =   55.847; ZVAL   =   16.000    mass and valenz
Fe_sv_GW/POTCAR:   POMASS =   55.847; ZVAL   =   16.000    mass and valenz
</code></pre>
<ul>
<li>还有把内层d轨道考虑到价电子层里面去的，比如：Ge_d。</li>
<li>某些元素，还有一些以 _h， _s 结尾的，应该是 hard和soft的缩写。带h的POTCAR中截断能比普通的要高出很多。带s的截断能要小很多。这里我们就可以通过grep 结合 ENMAX来查看一下：</li>
</ul>
<pre><code>$ grep ENMAX Ge*/POTCAR
Ge/POTCAR:   ENMAX  =  173.807; ENMIN  =  130.355 eV
Ge_d/POTCAR:   ENMAX  =  310.294; ENMIN  =  232.720 eV
Ge_d_GW/POTCAR:   ENMAX  =  375.434; ENMIN  =  281.576 eV
Ge_GW/POTCAR:   ENMAX  =  173.807; ENMIN  =  130.355 eV
Ge_h/POTCAR:   ENMAX  =  410.425; ENMIN  =  307.818 eV
Ge_sv_GW/POTCAR:   ENMAX  =  410.425; ENMIN  =  307.818 eV
</code></pre>
<p><strong>POTCAR的选择</strong></p>
<p>既然对于同一个元素，存在那么多的POTCAR类型，计算的时候我们改怎么选择呢？这里大师兄只能给的建议是：如果没有特别的需求，直接采用VASP官网推荐的即可。参考链接：</p>
<p>https://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html</p>
<p>我们在计算的时候，根据体系中的元素，将这些元素的POTCAR结合起来，组成一个新的POTCAR，这个结合的步骤，我们需要用到Linux的另一个命令：cat。比如VASP官网的例子，体系中含有Al， C，H三种元素。</p>
<pre><code>cat ~/pot/Al/POTCAR ~/pot/C/POTCAR ~/pot/H/POTCAR &gt;POTCAR
</code></pre>
<p>通过这一行命令就可以把Al，C，H各自的POTCAR结合在一起。OUTCAR中的元素顺序一定要和POSCAR保持一致,否则计算会出错，为了避免计算出错，还有一些高级的方法，这个在后面会慢慢讲解。</p>
<p>本节讲的是O原子的计算，官网推荐的氧原子POTCAR，默认的截断能是400，价层有6个原子。直接把O这个文件夹中的POTCAR直接复制到INCAR所在的目录即可。</p>
<p><strong>POTCAR检查常用的Linux命令：</strong></p>
<p>查看POTCAR中的元素:</p>
<pre><code>grep  TIT POTCAR
</code></pre>
<p>查看POTCAR的截断能: </p>
<pre><code>grep  ENMAX POTCAR
</code></pre>
<p>查看POTCAR中元素的价电子数目：</p>
<pre><code>grep  ZVAL POTCAR
</code></pre>
<p>举一反三，只要找到了关键词，我们就可以通过grep命令来进行查看。</p>
<h3 id="总结"><a class="header" href="#总结">总结：</a></h3>
<p>这一节，我们简单介绍了一下POTCAR中的内容，选取规则，以及通过grep命令和关键词进行查看。如果你能独立完成下面的几点，就圆满完成了本节的学习：</p>
<ul>
<li>VRHFIN， LEXCH，TITEL，ZVAL，ENMAX 这几个参数的大体意思；</li>
<li>初步了解：Fe_sv，Fe_pv， Ge_d,  Ge_gw，C_s, C_h 这些标记的含义；</li>
<li>查看VASP官网，了解VASP推荐的POTCAR；</li>
<li>使用grep来获取POTCAR中有价值的信息。</li>
</ul>
<p>通过本节（Ex01）的学习，大家初步了解VASP四个主要输入文件的是怎么制作的，一些简单参数的含义，以及每个文件所对应的格式和细节。本节我们分成了很多小节，每节内容都很多，但对新手来说，信息量可能有些大。但不需要一次性全部掌握，因为在后面的学习中，我们会逐渐深入。自己在课题进行的过程中，也会加深自己的理解。但书中要求掌握的部分，必须要牢牢记住。</p>
<p>本书的名字为：The Hard Way。意思是，学习VASP并不是一蹴而就的，需要一个长时间的积累过程。所以，新手切勿急躁，很多内容看不懂不要紧，务必要静下心来浏览一遍，自己跟着说明亲自去实践，切不可复制粘贴。 本节所讲解的东西，都务必去VASP官网找对应的说明，认真阅读，反复思考。养成潜心学习官网教程的良好习惯，从而远离网络上那些错误的信息。尤其是对于新手来说，很多都不懂的时候，没有自己的主见，别人一说就被牵着鼻子走了。</p>
<p><strong>相关的参考资料：</strong></p>
<ol>
<li>
<p>Vim使用练习：自己搜资料学习，百度里面很多，学会怎么输入，保存。</p>
</li>
<li>
<p>VASP文件: http://cms.mpi.univie.ac.at/vasp/guide/node50.html</p>
</li>
<li>
<p>INCAR:    http://cms.mpi.univie.ac.at/vasp/guide/node91.html</p>
</li>
<li>
<p>KPOINTS1:   http://cms.mpi.univie.ac.at/vasp/guide/node55.html</p>
</li>
<li>
<p>KPOINTS2:  https://cms.mpi.univie.ac.at/vasp/vasp/Automatic_k_mesh_generation.html</p>
</li>
<li>
<p>POSCAR1:   http://cms.mpi.univie.ac.at/vasp/guide/node59.html</p>
</li>
<li>
<p>POSCAR2:  https://cms.mpi.univie.ac.at/vasp/vasp/POSCAR_file.html</p>
</li>
<li>
<p>POTCAR1:   http://cms.mpi.univie.ac.at/vasp/guide/node54.html</p>
</li>
<li>
<p>POTCAR2:   https://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html</p>
</li>
<li>
<p>ISMEAR1:   http://cms.mpi.univie.ac.at/vasp/guide/node124.html</p>
</li>
<li>
<p>ISMEAR2:   http://cms.mpi.univie.ac.at/vasp/vasp/Number_k_points_method_smearing.html</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><hr />
<p>title: Ex02 做计算常用的批量处理方法（一）
categories: </p>
<ul>
<li>LVASPTHW
tags: </li>
<li>Linux 基本操作</li>
<li>批量处理
date: 2017-10-20 15:30:16</li>
</ul>
<hr />
<h3 id="回顾"><a class="header" href="#回顾">回顾</a></h3>
<p>前面一节大家已经学习了怎么制作文本格式的输入文件。回顾一下我们所学的东西：</p>
<ul>
<li>
<p>VASP必须有的输入文件都有哪些？  INCAR、KPOINTS、POSCAR、POTCAR</p>
</li>
<li>
<p>这些文件用什么编辑器修改或者制作？</p>
</li>
<li>
<p>文本内部格式都有哪些需要的注意事项？</p>
</li>
<li>
<p>目前学到的INCAR中各个参数代表的含义？</p>
</li>
<li>
<p>KPOINTS， POSCAR文本中每一行所代表的含义？</p>
</li>
<li>
<p>POTCAR中几个参数的含义。</p>
</li>
</ul>
<h3 id="批量处理"><a class="header" href="#批量处理">批量处理</a></h3>
<p>在提交VASP任务之前，我们先学习一下在Linux系统中常用的批量处理任务文件的办法。本书的宗旨是：稳中求快，欲速则不达。因此，不是所谓的速成教材，更不是10分钟学会XXX的理想手册。每一节的内容，都需要认真阅读，亲自上手操作练习。如果耐不住性子，请放弃本书的学习。而大师兄VASP多年的经验告诉我，批量处理在新手学习上有着非常重要的作用，因为很多参数他们不知道怎么去选择，但是，这种情况其实很好处理，只需要测试下就可以了。</p>
<h4 id="大家常用的测试方法"><a class="header" href="#大家常用的测试方法">大家常用的测试方法</a></h4>
<p>在VASP官网上，亦或者百度里面搜索的VASP教程里面，你可以找到很多个测试参数的小脚本，大部分都是这样的：参考链接：https://cms.mpi.univie.ac.at/wiki/index.php/Cd_Si</p>
<pre><code class="language-bash">#! /bin/bash
BIN=/path/to/your/vasp/executable
rm WAVECAR SUMMARY.dia
for i in  5.1 5.2 5.3 5.4 5.5 5.6 5.7 ; do
cat &gt;POSCAR &lt;&lt;!
cubic diamond
   $i 
 0.0    0.5     0.5
 0.5    0.0     0.5
 0.5    0.5     0.0
  2
Direct
 -0.125 -0.125 -0.125
  0.125  0.125  0.125
!
echo &quot;a= $i&quot; ; mpirun -n 2 $BIN
E=`awk '/F=/ {print $0}' OSZICAR` ; echo $i $E  &gt;&gt;SUMMARY.dia
done
cat SUMMARY.dia
</code></pre>
<p>然而，很多新手对linux的基本命令还不是很熟悉，更不用说脚本了。由于对于本书所默认的Linux基础为0的读者来说，上面的脚本会有些难度。因此，本节需要学习在linux系统下（确切点是在一个Terminal，终端里），一些基本的命令以及大师兄本人常用的批量处理任务文件的一个办法。</p>
<p>这时候你要问了，师兄，你的这个方法和VASP官网中的那个比起来，哪个更好啊？</p>
<p>其实本质是一样的。只是操作思路稍微有些区别。这个没有最好的，要根据你所要达到的目标，目前对程序的理解水平来定的。但是，你必须要学会一种，一个好的开始对于大家的后程发力和高效解决日常任务非常重要。</p>
<h4 id="linux里面的一些基本命令"><a class="header" href="#linux里面的一些基本命令">Linux里面的一些基本命令</a></h4>
<p>首先：教给大家常用的查看（进入）目录，查看文件的几个相关的命令: ls，  cat，和  grep。</p>
<p>通过这几个命令复习并查看上一节我们制作的输入文件: INCAR， KPOINTS， POSCAR 和POTCAR。</p>
<p>大师兄在超算中心的一些具体的基本操作。大家可以照着命令自己练习下面的几个命令。先敲一遍，看下输出结果。（老司机自动跳过）</p>
<pre><code class="language-bash">[iciq-lq@ln3%th2 ~]$ ls
bin  LVASPTHW
[iciq-lq@ln3%th2 ~]$ cd LVASPTHW/
[iciq-lq@ln3%th2 LVASPTHW]$ ls
ex01
[iciq-lq@ln3%th2 LVASPTHW]$ cd ex01/
[iciq-lq@ln3%th2 ex01]$ ls
INCAR  KPOINTS  POSCAR  POTCAR
[iciq-lq@ln3%th2 ex01]$ pwd 
/THFS/home/iciq-lq/LVASPTHW/ex01
[iciq-lq@ln3%th2 ex01]$ 
[iciq-lq@ln3%th2 ex01]$ cat INCAR  
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.01      
[iciq-lq@ln3%th2 ex01]$ cat KPOINTS 
K-POINTS  
 0  
Gamma
1 1 1
0 0 0 
[iciq-lq@ln3%th2 ex01]$ cat POSCAR  
O atom in a box 
1.0            
8.0 0.0 0.0   
0.0 8.0 0.0  
0.0 0.0 8.0 
O          
1         
Cartesian
0 0 0           #
[iciq-lq@ln3%th2 ex01]$ 
[iciq-lq@ln3%th2 ex01]$ grep TIT POTCAR  
   TITEL  = PAW_PBE O 08Apr2002
[iciq-lq@ln3%th2 ex01]$ 
[iciq-lq@ln3%th2 ex01]$ grep EMAX POTCAR 
[iciq-lq@ln3%th2 ex01]$ grep ENMAX POTCAR 
   ENMAX  =  400.000; ENMIN  =  300.000 eV
[iciq-lq@ln3%th2 ex01]$ 

</code></pre>
<p><strong>详解:</strong> </p>
<p>1） ls 命令：列出来当前目录下的所有文件和文件夹；</p>
<p>2） cd： 进入文件夹所在的目录；</p>
<p>3） pwd：显示当前所在的绝对目录。</p>
<p>4）  cat 后面加上文件名，就可以在输出里面查看该文件的内容：cat 和文件名之间有空格， 可以是一个，也可以是N个。（上一节，我们也提到使用cat命令来生成VASP的POTCAR）</p>
<p>5） 对于一个大文件来说，里面有很多行， 用cat就不方便查看了， 我们可以用grep这个命令提取出来所需要的信息，比如上一节的POTCAR文件，复习下上节的操作：</p>
<ul>
<li>例子1：我们想知道POTCAR中包含的元素，可以用: grep TIT POTCAR ， </li>
</ul>
<p>TIT就是POTCAR中的一个固定的字符，通过提取这个字符，获取我们需要的结果，这里我们知道了 POTCAR中含有O元素;</p>
<ul>
<li>
<p>例子2：通过使用：grep ENMAX POTCAR  可以获取POTCAR中O元素的截断能是400 eV;</p>
</li>
<li>
<p>**注意：**grep 后面提取的字符，最好在文件中是唯一存在的或者只出现几次。否则我们不容易得到期望的结果; 大家可以运行下面这两个命令，感受下结果;</p>
</li>
</ul>
<pre><code class="language-bash">grep EMAX POTCAR
grep  PBE POTCAR  
grep  0  POTCAR  （可以是0，也可以是字母O）
</code></pre>
<p>6） 查看文件的命令还有 more，例如下面的操作：</p>
<pre><code class="language-bash">[iciq-lq@ln3%th2 ex01]$ ls
INCAR  KPOINTS  POSCAR  POTCAR
[iciq-lq@ln3%th2 ex01]$ 
[iciq-lq@ln3%th2 ex01]$ more  INCAR  
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.01      
[iciq-lq@ln3%th2 ex01]$ more POSCAR  
O atom in a box 
1.0            
8.0 0.0 0.0   
0.0 8.0 0.0  
0.0 0.0 8.0 
O          
1         
Cartesian
0 0 0           #
[iciq-lq@ln3%th2 ex01]$ 
</code></pre>
<ol start="7">
<li>或者less， 运行less 命令 后，会显示文件的内容，</li>
</ol>
<ul>
<li>
<p>如果要退出 敲一下 q 键即可;</p>
</li>
<li>
<p>如果想编辑文件，再敲一下键盘上的v键，则可以直接进入vim 的编辑界面。退出时和vim的退出方法是一样的。</p>
</li>
</ul>
<h3 id="总结-1"><a class="header" href="#总结-1">总结</a></h3>
<p>本节的内容虽名为详解，实为简介！如果想学的更加深入还要靠自己百度查找相关的Linux命令学习手册，ppt等，平时多加操练。但，请不要让我推荐参考书给你。百度搜索关键词： Linux命令 即可。到现在，我们讲到的Linux基本命令有： ls，cd，pwd，cat，grep，more，less 以及vim 这个编辑器。如何才能圆满达到本节的要求呢？</p>
<p>1） 熟练操作使用这些命令；</p>
<p>2） 搜索百度，尝试一些教程相关的学习；</p>
<p>3） 养成遇到不会的命令，就自己<strong>主动</strong>认真搜索学习的习惯。</p>
<p>上一小节，我们学习了一些基本的linux操作，今天我们学习下文件以及文件夹的操作命令：mkdir, cp，mv以及一个简单的for循环。</p>
<p><strong>文件（夹）的操作命令：</strong></p>
<p>1 mkdir 是创建文件夹的一个命令，后面紧跟着你要创建的文件夹的名字。mkdir的使用，有很多敲门。大家可以百度关键词查找： mkdir 窍门，小诀窍 等等。创建一个名字为：ex02的文件夹，然后进入，再创建一个birbro的文件夹: </p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq$ ls
bin  LVASPTHW
iciq-lq@ln3:/THFS/home/iciq-lq$ 
iciq-lq@ln3:/THFS/home/iciq-lq$ cd LVASPTHW/
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ ls
ex01
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ mkdir ex02
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ cd ex02
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ mkdir bigbro 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$
</code></pre>
<p>2 cp这个命令适用于文件以及文件夹的复制。比如：</p>
<p>2.1） 将bigbro 这个文件夹复制名为: bigbra</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cp bigbro bigbra 
cp: omitting directory `bigbro'
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cp bigbro bigbra -r 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
bigbra  bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ 
</code></pre>
<ul>
<li>
<p>如果复制文件夹的时候，如上图，出现<strong>cp: omitting directory</strong>这个错误，在cp命令后，或者前面命令的结尾加上-r即可。</p>
</li>
<li>
<p>复制文件的时候，不用加 -r。</p>
<pre><code>cp -r  bigbro bigbra
cp bigbro bigbra -r
</code></pre>
</li>
</ul>
<p>2.2） 将ex01中的四个输入文件复制到bigbra这个文件夹中：</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cp ../ex01/
INCAR    KPOINTS  POSCAR   POTCAR   
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cp ../ex01/* bigbr
bigbra/ bigbro/ 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cp ../ex01/* bigbra/
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls *
bigbra:
INCAR  KPOINTS  POSCAR  POTCAR

bigbro:

</code></pre>
<ul>
<li>学会用tab键来提高自己在终端输入的速度，最上面2个cp的命令都是tab的结果。
<ul>
<li>第一次使用tab，可以列出来ex01中所有的文件；</li>
<li>第二次使用tab，可以列出来当前目录下所有以b开头的文件夹；</li>
</ul>
</li>
<li>学会用*来查看某个目录下所有的内容。</li>
</ul>
<p>3 mv 是Linux中： 转移、重命名文件（夹）的一个命令，</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ mv bigbra bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ cd bigbro/
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02/bigbro$ ls
bigbra
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02/bigbro$ mv bigbra/ 0.01
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02/bigbro$ ls 
0.01
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02/bigbro$ cd ../
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ mv bigbro/0.01/ .
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ 
</code></pre>
<ul>
<li>
<p>把bigbra 文件移动到bigbro里面；</p>
</li>
<li>
<p>进入bigbro文件夹；</p>
</li>
<li>
<p>将bigbra文件夹重命名为： 0.01</p>
</li>
<li>
<p>返回上一层的目录；</p>
</li>
<li>
<p>将bigbro中的0.01移动到当前的目录下（当前的目录，命令中用点.来代替。）；</p>
</li>
</ul>
<p><strong>问题来了：</strong></p>
<p>现在我们需要完成下面的任务：</p>
<p>1）创建从0.02，0.03到0.10，共9个文件夹，</p>
<p>2）每个文件夹中都有与0.01文件夹中相同KPONTS, POSCAR，POTCAR</p>
<p>3）每个文件夹中都有INCAR，但INCAR中SIGMA这个参数的取值和文件夹的名字一样，其他参数和0.01的相同。</p>
<p>为实现这个小目标，我们可以这样做：将0.01复制成0.02,0.03...0.10，然后挨个修改里面的INCAR文件。如下：</p>
<pre><code>cp 0.01 0.02
cp 0.01 0.03
......
cp 0.01 0.10
vi 0.02/INCAR
vi 0.03/INCAR
......
</code></pre>
<ul>
<li>小窍门：运行完第一个命令后，敲一下键盘的向上箭头，就会出现刚刚运行的命令，直接修改最后一个数字即可。</li>
</ul>
<p><strong>神奇的for循环</strong></p>
<p>但大师兄不想挨个创建这9个文件夹，也不想挨个编辑修改INCAR文件中的SIGMA数值。想必大家都不想这么做，因此，在这里教给大家使用一个for循环来快速实现我们的小目标。</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls
0.01  bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ rm bigbro/ -fr 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ for i in {2..9}; do cp 0.01 0.0$i ; done 
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
cp: omitting directory `0.01'
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ for i in {2..9}; do cp 0.01 0.0$i -r ; done 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ ls 
0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex02$ 
</code></pre>
<p>上面我们先删掉了bigbro文件夹；</p>
<p>然后使用for循环，发现没有加-r，复制的时候出错了</p>
<p>加上-r之后，for循环顺利的完成了小目标</p>
<p><strong>for循环详解:</strong></p>
<p>1）  {2..9} 是为了获取从2到9的所有数字， 有以下几点需要注意:</p>
<ul>
<li>
<p>for i in {2..9} 和 for i in 2 3 4 5 6 7 8 9 效果是一样的</p>
</li>
<li>
<p>用的是花括号</p>
</li>
<li>
<p>2和9中间有两个点 ..</p>
</li>
<li>
<p>两个点之间没有空格， 2，9 与两个点之间也没有空格。</p>
</li>
<li>
<p>不要用中文输入法敲命令。</p>
</li>
</ul>
<p>2）大家还可以练习下面这几个命令来看一下效果:  echo是打印输出的命令。</p>
<pre><code>echo {1..100} 
echo {A..Z}
echo {a..z}
echo {a..z}{1..10}{A..Z}
</code></pre>
<p>3） for i in {2..9} : 翻译过来就是:对于从2到9的任意数字 i， i在这里是一个变量；我们给 i 赋值，值的范围是 从2到9 ; 两点需要注意:</p>
<ul>
<li>
<p>i 只是个人喜好而已， 你也可以用 for a in  XXX ; for b in XXX;</p>
</li>
<li>
<p>in 后面是一个 集合; 怎么选取这个集合决定了for循环的威力;</p>
</li>
</ul>
<p>4）  for i in XXX  这个句字后面跟着一个分号，如果没有便会出错。分号前后可以有空格，也可以没有，为了让自己写的东西更加直观，建议加上空格; </p>
<p>5） do 翻译过来就是: 我们要实现什么任务，目的; do 后面跟一个空格， 或者几个空格 </p>
<p>6） cp 0.01  0.0$i   -r</p>
<ul>
<li>
<p>cp 0.01 把 0.01 这个文件夹复制成 0.0$i 文件夹;</p>
</li>
<li>
<p>$i 被替换成for后面变量 i 的值;</p>
</li>
</ul>
<p>7） 复制完成后，后面跟着一个分号;</p>
<p>8） done 完成任务。</p>
<p>9）大家可以尝试着其他类似的命令： for i in XXX; do XXX ; done  比如: </p>
<pre><code>for bigbro in {A..Z}; do echo bigbro is $bigbro ; done
</code></pre>
<p>这个例子只是为了说明：</p>
<ul>
<li>for 后面的变量如果你用 i 表示，那么后面就用$i 来引用；</li>
</ul>
<ul>
<li>如果用bigbro 来表示，后面则用$bigbro; </li>
<li>$和后面的变量之间(bigbro)没有空格。（你可以加上空格，看看有什么错误出现！）</li>
</ul>
<p><strong>思考下：</strong></p>
<p>对于一个文件A，我们的目的是将A重命名为B。有下面2种操作可供选择：</p>
<p>第一种） mv A B </p>
<p>第二种） cp A B 然后 rm A </p>
<p>从结果上来说，这两种做法都是可以的。这里大师兄想告诉你的是：</p>
<p>i） 尽量找最简单的方法（第一种）实现所期望的目的；</p>
<p>ii） 如果不知道最简单的方法， 那么可以尝试其他方式来解决（第二种）。</p>
<p><strong>小结:</strong></p>
<p>通过本小节的学习：一方面我们熟悉文件（夹）创建，复制，移动以及重命名的linux命令：mkdir， mv， cp。另一方面，初步掌握for循环来实现批量处理的效果。请大家务必多加操练，以及完成扩展练习。至少图中的例子要练习一遍，能看懂什么意思。本节的for循环，我们只完成了一半的任务，每个文件夹中的INCAR还没有修改，下一节我们介绍另一个批量处理的方法来实现这个目的。</p>
<p>此外， linux的命令操作有很多的小技巧，大家一定要多多去网上搜集，加以练习，这对于提高工作效率非常有帮助。</p>
<div style="break-before: page; page-break-before: always;"></div><hr />
<p>title: Ex03 做计算常用的批量处理方法（三）
categories: </p>
<ul>
<li>LVASPTHW
tags: </li>
<li>for 循环</li>
<li>批量处理</li>
<li>sed
date: 2017-10-22 15:30:16</li>
</ul>
<hr />
<p>前面练习中我们在0.01的文件夹基础上，通过一个命令，复制得到了从0.02到0.09的文件夹。但是， 所有文件夹中的输入文件都是一样的，我们还需要把INCAR中的SIGMA参数值 SIGMA = 0.01 改成与文件夹对应的数值。 首先我们可以逐个进行编辑，但太浪费时间，这也不是大师兄的风格。Ex03练习分为2小节：</p>
<ul>
<li>新命令 sed 的学习</li>
<li>for + sed 组合</li>
</ul>
<p>最终我们会结合for循环和sed命令，来学会批量处理输入文本的另一个方法。**还是要强调一下：**大家要主动，多去网上找资料，并系统性的学习linux下面的基本命令。光指望着本书中的这么一点，是很难提高的。</p>
<p>qli@bigbrosci Ex02 % for i in 0.{02..10}; do sed -i &quot;s/0.01/$i/g&quot;  $i/INCAR ;done 
qli@bigbrosci Ex02 % cat 0.05/INCAR
SYSTEM = O atom 
ISMEAR = 0<br />
SIGMA = 0.05</p>
<h3 id="复习上一节的功课"><a class="header" href="#复习上一节的功课">复习上一节的功课</a></h3>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ ls
ex01  ex02
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ mkdir ex03 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ cp ex02/0.01 ex03 -r 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW$ cd ex03/0.01/
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.01      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  -n 
     1	SYSTEM = O atom 
     2	ISMEAR = 0       
     3	SIGMA = 0.01      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ 

</code></pre>
<p>上面的操作依次为：</p>
<ul>
<li>
<p>新建ex03文件夹</p>
</li>
<li>
<p>将ex02中的0.01 复制到ex03中</p>
</li>
<li>
<p>进入ex03/0.01的目录中</p>
</li>
<li>
<p>使用cat 查看0.01中INCAR的内容</p>
</li>
<li>
<p>使用cat -n 查看INCAR中的内容，该选项在输出中给每一行标出了行数，方便我们查看。</p>
</li>
</ul>
<p><strong>注意:</strong> </p>
<p>1）Linux 下面的命令都有很多的选项，用以丰富我们的不同需求，比如上面的 cat -n，可以使用 man cat 这个命令查看 cat 的其他选项。使用这个命令后，如果想退出，敲 q 键即可;</p>
<p>2）另外，我们也可以使用 cat –help 来查看，效果与man cat 一样。</p>
<p><strong>sed 命令修改INCAR</strong></p>
<p>前面我们提到，可以使用vim打开INCAR然后修改SIGMA的参数。除了vim当然还有文本编辑器等其他的工具。但这些工具都有个缺点，就是得把文件打开后才能修改。下面我们使用sed命令，不打开文本，直接对里面的内容进行替换操作。</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed '3s/0.01/0.02/g' INCAR 
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.02      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.01      
</code></pre>
<p><strong>精解：</strong></p>
<ol>
<li>
<p>单引号中是我们的操作， 3s 表示的是选择第三行，因为我们知道 0.01 在第三行中出现，s 是substitute 的缩写</p>
</li>
<li>
<p>3s 后面跟一个斜杠 /  用来和后面被替换的内容分开，这里0.01 表示选择第三行的0.01;</p>
</li>
<li>
<p>0.01后面再用一个斜杠，将其和替换后的数字分开(0.01  0.02  0.03 等)，表示将0.01替换为斜杠后面的内容;</p>
</li>
<li>
<p>再加一个斜杠，后面的g 代表 global ，意思是全部替换。</p>
</li>
<li>
<p>输入完毕后，我们选择要执行该命令的对象(要替换的文件)，也就是当前目录下INCAR 文件。</p>
</li>
<li>
<p>命令的意思就是：我们用sed命令，将INCAR中的第三行的0.01全部替换成0.02。</p>
</li>
</ol>
<p>从上面实例中最后的cat INCAR命令结果不难发现，实际上我们并没有将INCAR文件中的0.01替换成0.02。也就是说这个命令只是输出了替换后的结果，但没有更新INCAR文件。那怎么样才可以更新INCAR文件呢？ 我们可以这样做：</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed '3s/0.01/0.02/g' INCAR &gt; INCAR_new
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR_new 
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.02      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ mv INCAR_new  INCAR 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.02      
</code></pre>
<p>箭头（&gt;）的意思是：我们将命令的输出存到一个新的文件INCAR_new中，</p>
<p>通过mv命令之前的INCAR替换掉。</p>
<p>但，这样做也太麻烦了，更简单一点，如下：</p>
<p>前面例子的INCAR中SIGMA的值已经不是0.01了，我们先从ex02/0.01中复制一个过来。</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cp ../../ex02/0.01/INCAR  .
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  -n 
     1	SYSTEM = O atom 
     2	ISMEAR = 0       
     3	SIGMA = 0.01      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed -i '3s/0.01/0.02/g' INCAR 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  -n 
     1	SYSTEM = O atom 
     2	ISMEAR = 0       
     3	SIGMA = 0.02      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ 

</code></pre>
<p><strong>详解：</strong></p>
<p>sed –i 是sed 的命令和其附加选项， -i 表示直接对源文件进行编辑，也就是说编辑之后源文件被新文件替换掉。因此，使用这个参数的时候要小心，小心，再小心。要格外小心！！！</p>
<ul>
<li>最保险的做法就是运行前，先对操作的对象进行备份：如下：</li>
</ul>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cp INCAR  INCAR_back
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed -i '3s/0.01/0.02/g' INCAR 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ ls
INCAR  INCAR_back  KPOINTS  POSCAR  POTCAR
</code></pre>
<ul>
<li>其次是，先不加 -i 运行下sed命令，确保输出的是正确结果后，然后再加上 -i 运行.</li>
</ul>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cp INCAR_back  INCAR 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed '3s/0.01/0.02/g' INCAR
SYSTEM = O atom 
ISMEAR = 0       
SIGMA = 0.02      
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ sed -i '3s/0.01/0.02/g' INCAR
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03/0.01$ cat INCAR  -n 
     1	SYSTEM = O atom 
     2	ISMEAR = 0       
     3	SIGMA = 0.02    
</code></pre>
<p><strong>小结:</strong></p>
<p>sed 是一个非常强大的命令，对于做计算的我们来说，熟练正确地使用sed可以极大的提高我们的工作效率，大家务必硬着头皮掌握这个命令。这个网站列举了一些基本的用法：</p>
<p><strong>http://man.linuxde.net/sed</strong> </p>
<p>大家参照着进行练习，也可以百度里面搜索一些其他的 sed 使用技巧，如果你有认为很好的sed 技巧，也可以发邮件分享给大师兄（lqcata@gmail.com）。</p>
<p>本节我们学习2个批量操作：</p>
<ul>
<li>通过sed单个命令进行批量操作</li>
<li>以及sed + for循环的批量操作</li>
</ul>
<p>1  sed 批量将0.01到0.09中所有INCAR中的0.01替换成0.05。到现在为止，相信大家都可以看懂下面的命令操作。就不再啰嗦解释了。有一点需要注意的是grep 命令中的星号，检查输入输出的时候用*非常方便。</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ ls
0.01
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ for i in {2..9}; do cp 0.01 0.0$i -r ; done 
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ ls 
0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ grep SIGMA */INCAR
0.01/INCAR:SIGMA = 0.01
0.02/INCAR:SIGMA = 0.01
0.03/INCAR:SIGMA = 0.01
0.04/INCAR:SIGMA = 0.01
0.05/INCAR:SIGMA = 0.01
0.06/INCAR:SIGMA = 0.01
0.07/INCAR:SIGMA = 0.01
0.08/INCAR:SIGMA = 0.01
0.09/INCAR:SIGMA = 0.01
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ sed -i '3s/0.01/0.05/g' */INCAR
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ grep SIGMA */INCAR
0.01/INCAR:SIGMA = 0.05
0.02/INCAR:SIGMA = 0.05
0.03/INCAR:SIGMA = 0.05
0.04/INCAR:SIGMA = 0.05
0.05/INCAR:SIGMA = 0.05
0.06/INCAR:SIGMA = 0.05
0.07/INCAR:SIGMA = 0.05
0.08/INCAR:SIGMA = 0.05
0.09/INCAR:SIGMA = 0.05
</code></pre>
<p>2 for 循环结合sed </p>
<p>前面我们使用sed命令，将文件夹中所有的0.01替换成了0.05。但我们的目标是，每个文件夹中的SIGMA值与文件夹相同。既然我们知道了sed可以对单个文件进行操作，那么我们也可以结合for循环，来实现一个批量操作的目的。命令如下：</p>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ ls
0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ for i in *; do sed -i &quot;3s/0.05/$i/g&quot; $i/INCAR ; done  
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ grep SIGMA */INCAR
0.01/INCAR:SIGMA = 0.01
0.02/INCAR:SIGMA = 0.02
0.03/INCAR:SIGMA = 0.03
0.04/INCAR:SIGMA = 0.04
0.05/INCAR:SIGMA = 0.05
0.06/INCAR:SIGMA = 0.06
0.07/INCAR:SIGMA = 0.07
0.08/INCAR:SIGMA = 0.08
0.09/INCAR:SIGMA = 0.09

</code></pre>
<p><strong>注意：</strong></p>
<ul>
<li>这里我们用的是双引号 &quot; &quot; ，sed 命令中你会见到大部分都用单引号 ' ' 。但如果这里使用单引号，则所有的 0.01 都会被替换成 $i (单引号中的$i 是纯字符)，因为单引号中的所有内容都会被当做字符来处理，也就是里面是什么就输出什么。使用双引号，则可以读取变量 $i 的值，下面的例子大家一看就知道怎么回事了:</li>
</ul>
<pre><code>iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ abc=bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ echo abc
abc
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ echo '$abc'
$abc
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ echo $abc
bigbro
iciq-lq@ln3:/THFS/home/iciq-lq/LVASPTHW/ex03$ echo &quot;$abc&quot;
bigbro
</code></pre>
<p>这里单引号中的内容被原封不动地打印出来了。而双引号的话，则可以顺利地把变量调用起来。</p>
<ul>
<li>for i in *;  这里的 * 指的是当前目录下所有的文件以及文件夹，本例中没有文件，只有从0.01， 0.02， 0.03 到 0.09 的文件夹；所以： for i in  *  =   for i in 0.01  0.02 0.03  0.04  0.05 0.06  0.07  0.08 0.09</li>
</ul>
<p>1.5.2 使用sed 命令将INCAR中的 0.05 (所有文件夹中的都是0.05)替换成文件夹的数字;</p>
<pre><code>sed -i &quot;3s/0.05/$i/g&quot; $i/INCAR 
</code></pre>
<p>当$i的值为0.01的时候，我们就把0.01/INCAR中的0.05替换为0.01；为0.02的时候，就把0.02/INCAR中的0.05替换为0.02，依次类推，直至for循环完成。</p>
<p>1.6 该命令瞬间运行完成，我们使用grep SIGMA 来查看下这些文件夹中的INCAR参数 ，圆满完成任务!</p>
<hr />
<h3 id="总结-2"><a class="header" href="#总结-2">总结</a></h3>
<p>在ex03的练习中，我们并不着急去提交任务，反正已经走了计算的路，以后提交任务的机会还多着呢，也不差这一两天的学习时间。先从简单到复杂些，逐渐掌握Linux的一节操作命令，对以后的学习帮助很大。</p>
<ol>
<li>
<p>学会 man command 或者 command –help 查看命令的具体参数;</p>
</li>
<li>
<p>大量使用sed 命令进行操作练习;</p>
</li>
<li>
<p>知道 * 在for循环中代表的含义</p>
</li>
<li>
<p>熟知单引号和双引号的使用，以及区别</p>
</li>
<li>
<p>主动搜索相关的Linux命令的相关知识，积极操练。</p>
</li>
<li>
<p>学会从单一操作，通过for循环转化成批量操作的思路。</p>
</li>
</ol>
<ul>
<li>for i in XXX; do YYY; done </li>
<li>XXX就是我们要操作的范围或者对象</li>
<li>YYY就是单一的一个操作。</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
